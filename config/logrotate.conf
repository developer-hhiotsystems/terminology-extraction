# Log Rotation Configuration for Glossary App
# Place in /etc/logrotate.d/glossary-app (Linux)

/var/www/glossary-app/logs/*.log {
    # Rotate daily
    daily

    # Keep 30 days of logs
    rotate 30

    # Compress old logs
    compress

    # Delay compression until next rotation
    delaycompress

    # Don't rotate empty logs
    notifempty

    # Create new log files with specified permissions
    create 0640 www-data www-data

    # Use date extension for rotated files
    dateext
    dateformat -%Y%m%d

    # Don't error if log file is missing
    missingok

    # Run these commands after rotation (only once)
    sharedscripts
    postrotate
        # Reload application to use new log file
        systemctl reload glossary-api > /dev/null 2>&1 || true
    endscript
}

# Separate configuration for error logs (keep longer)
/var/www/glossary-app/logs/errors.log {
    daily
    rotate 90  # Keep 90 days of error logs
    compress
    delaycompress
    notifempty
    create 0640 www-data www-data
    dateext
    dateformat -%Y%m%d
    missingok
    sharedscripts
    postrotate
        systemctl reload glossary-api > /dev/null 2>&1 || true
    endscript
}
